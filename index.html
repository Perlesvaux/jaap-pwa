<!DOCTYPE html>
<html lang='es'>

<head>
   <meta charset='UTF-8'>
   <meta name='viewport' content='width=device-width, initial-scale=1.0'>

   <!-- <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css'> -->
   <link rel='stylesheet' href='style.css'>

   <link rel="manifest" href="manifest.json" />
   <link rel="icon" href="favicon.png" />

   <script type='module' src='app.js'></script>

   <title>Registro JAAP</title>
</head>

<body>
   <h1>Registro de la Junta Administradora de Agua Potable</h1>

   <nav>
      <div>

         <input type='button' value='medidores' id='meters-section'>
         <input type='button' value='csv' id='csv-section'>

      </div>

      <search id='meter-search'>

         <div>
            <label for='history'>Tabla</label>
            <select id='history'></select>
         </div>

         <div>
            <label for='meter-filter'>Filtrar</label>
            <input id='meter-filter' type='search' spellcheck='false' size='18'>
         </div>

         <input type='button' id='meter-add-btn' value='+ medidor'>
         <input type='button' id='reading-btn' value='+ lectura'>
         <input type='button' value='&#8628; .csv' id='export-csv'>
         <input type='button' value='&#8628; .json' id='export-json'>

         <div class='switch-box' id='meters-switches'></div>

      </search>

      <search id='csv-search' hidden>

         <label for='csv-btn'>abrir .csv</label>
         <input type='file' id='csv-btn' accept='.csv' hidden>

         <div>
            <label for='csv-filter'>Filtrar</label>
            <input id='csv-filter' type='search' spellcheck='false' size='18' disabled>
         </div>

         <div class='switch-box' id='csv-switches'></div>

      </search>

   </nav>

   <!-- Meter-registration dialogs: -->

   <!-- For registering a new meter: -->

   <dialog>
      <form method='dialog' id='meter-form'>
         <label for='medidor' class='form-label'>medidor</label>
         <input id='medidor' class='form-control' type='number' required placeholder='020318' name='medidor'>

         <label for='zona' class='form-label'>zona</label>
         <input id='zona' class='form-control' type='number' required min='1' max='12' placeholder='7' name='zona'>

         <label for='titular' class='form-label'>titular</label>
         <input id='titular' class='form-control' type='text' required placeholder='José María López Rivera'
            name='titular'>

         <label for='caserío' class='form-label'>caserío</label>
         <input id='caserío' class='form-control' type='text' required placeholder='La Profética' name='caserío'
            list='suggested-caseríos'>

         <datalist for='caserío' id='suggested-caseríos'></datalist>

         <label for='lectura-inicial' class='form-label'>lectura inicial</label>
         <input id='lectura-inicial' class='form-control' type='number' required min='0' value='0'
            name='lectura_anterior'>

         <label for='fecha-inicial' class='form-label'>fecha de lectura inicial</label>
         <input id='fecha-inicial' class='form-control' type='date' required name='desde'>

         <!-- <label for='deuda' class='form-label'>Deuda</label>
         <input id='deuda' class='form-control' type='number' required min='0' step='0.01' value='0'> -->

         <input type='submit' value='Agregar'>
         <input type='button' value='Cancelar' onclick='this.parentElement.parentElement.close()'>
      </form>
   </dialog>

   <!-- To confirm the new meter has been successfully added: -->

   <dialog>
      <form method='dialog' id='meter-added-form'>
         <p>Medidor agregado exitosamente!</p>
         <input type='submit' value='Ok'>
      </form>
   </dialog>

   <!-- Error dialog when the user tries to register a meter already registered: -->

   <dialog>
      <form method='dialog' id='meter-error-form'>
         <p>Error: El medidor <span id='meter-repeated'></span> ya existe!</p>
         <input type='submit' value='Ok'>
      </form>
   </dialog>

   <!-- Meter-reading dialogs: -->

   <!-- For adding a new meter reading: -->

   <dialog>
      <form method='dialog' id='reading-form'>
         <label for='meter-being-read'>Medidor</label>
         <input id='meter-being-read' type='number' required name='medidor' list='suggested-meters'>

         <datalist for='meter-being-read' id='suggested-meters'></datalist>

         <label for='meter-reading'>Lectura</label>
         <input id='meter-reading' type='number' required name='lectura_actual'>

         <label for='fecha-lectura-actual' class='form-label'>fecha de lectura</label>
         <input id='fecha-lectura-actual' class='form-control' type='date' required name='hasta'>

         <input type='submit' value='Ok'>
         <input type='button' value='Cancelar' onclick='this.parentElement.parentElement.close()'>
      </form>
   </dialog>

   <!-- To confirm that the meter reading has been successfully registered: -->

   <dialog>
      <form method='dialog' id='read-confirm-form'>
         <p>Lectura tomada exitosamente!</p>
         <input type='submit' value='Ok'>
      </form>
   </dialog>

   <!-- Error when the user tries to add a reading for a meter that doesn't exist: -->

   <dialog>
      <form method='dialog' id='meter-non-existant-form'>
         <p>El medidor <span id='non-existant-meter'></span> aún no está registrado!</p>
         <input type='submit' value='Ok'>
      </form>
   </dialog>

   <!-- Error when the user attempts to create a new period table by reading a meter that was already read this period, while still having other unread meters this period: -->

   <dialog>
      <form method='dialog' id='meter-already-read-form'>
         <p>No se puede registrar una nueva lectura para el medidor <span class='already-read-meter'></span>, porque eso
            crearía una nueva tabla para un nuevo periodo, siendo que aún quedan medidores sin leer en este periodo.</p>
         <p>Para registrar una nueva lectura para el medidor <span class='already-read-meter'></span>, tiene 2 opciones:
         </p>
         <p>1- Registrar una lectura para los medidores que faltan (puede poner la misma lectura del periodo anterior).
         </p>
         <p>2- Borrar los medidores no leídos de la tabla actual.</p>
         <p>Si borra los medidores no leídos, estos no aparecerán en la tabla del siguiente periodo, y si necesita
            leerlos en el futuro, tendrá que volver a registrarlos.</p>
         <input type='submit' value='Ok'>
      </form>
   </dialog>

   <!-- todo: error fecha de toma de medida less than previous one -->
   <main>
      <table id='meters-table' class='table table-striped table-bordered'></table>
      <table id='csv-table' class='table table-striped table-bordered' hidden></table>
   </main>
</body>

</html>